<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.StoredProcedureOraclev10g" name="REFUND_RECPT_MKR" directorySegmentName="seg_0" id="423CE629-4769-7E5A-9A2F-D4099999109D">
<sourceConnName>cocoFarm</sourceConnName>
<sourceObjSchema>COCOFARM</sourceObjSchema>
<sourceObjName>REFUND_RECPT_MKR</sourceObjName>
<createdBy>Sonn</createdBy>
<createdTime>2018-06-17 09:48:31 UTC</createdTime>
<ownerDesignName>cocoDataModel</ownerDesignName>
<owner>9B2CBDD9-D4EA-AD8B-3936-1238B79FFDD3</owner>
<source>CREATE OR REPLACE procedure COCOFARM.REFUND_RECPT_MKR ( in_recpt_idx MAIN_RECEIPT.IDX%type, in_pay_code MAIN_RECEIPT.PAYMENT_CODE%type, isDone out number)&lt;br/&gt;is&lt;br/&gt;	v_payment_code		MAIN_RECEIPT.PAYMENT_CODE%type;&lt;br/&gt;	v_buyer_idx			MAIN_RECEIPT.BUYER_IDX%type;&lt;br/&gt;	v_money_amount		MAIN_RECEIPT.MONEY_AMOUNT%type;&lt;br/&gt;	v_paid_name			MAIN_RECEIPT.PAID_NAME%type;&lt;br/&gt;	v_state_code		MAIN_RECEIPT.STATE_CODE%type;&lt;br/&gt;&lt;br/&gt;	err_code			number;&lt;br/&gt;	err_message			varchar2(255);&lt;br/&gt;begin&lt;br/&gt;	savepoint START_TRANSACTION;&lt;br/&gt;&lt;br/&gt;	update MAIN_RECEIPT set STATE_CODE = 3, PAYMENT_CODE = in_pay_code where IDX = in_recpt_idx;&lt;br/&gt;	select PAYMENT_CODE, BUYER_IDX, MONEY_AMOUNT, PAID_NAME, STATE_CODE&lt;br/&gt;		into v_payment_code, v_buyer_idx, v_money_amount, v_paid_name, v_state_code&lt;br/&gt;		from MAIN_RECEIPT where IDX = in_recpt_idx;&lt;br/&gt;	insert into MAIN_RECEIPT (PAYMENT_CODE, BUYER_IDX, MONEY_AMOUNT, PAID_NAME, STATE_CODE, REFUND_OF)&lt;br/&gt;		values (v_payment_code, v_buyer_idx, v_money_amount, v_paid_name, 4, in_recpt_idx);&lt;br/&gt;	insert into PLOGGER (NAME, RESULTCODE, CONTENT) values (&apos;REFUND_RECPT_MKR&apos;, 1, &apos;in_recpt_idx: &apos;||in_recpt_idx);&lt;br/&gt;	commit;&lt;br/&gt;	select 1 into isDone from DUAL;&lt;br/&gt;&lt;br/&gt;exception when OTHERS then&lt;br/&gt;&lt;br/&gt;	err_code := sqlcode;&lt;br/&gt;	err_message := substr(sqlerrm, 1, 255);&lt;br/&gt;&lt;br/&gt;	insert into PLOGGER (NAME, RESULTCODE, CONTENT, err_code, err_message) values (&apos;REFUND_RECPT_MKR&apos;,0,&apos;ERROR! (in_recpt_idx: &apos;||in_recpt_idx||&apos;)&apos;, err_code, err_message );&lt;br/&gt;	commit;&lt;br/&gt;&lt;br/&gt;	select 0 into isDone from DUAL;&lt;br/&gt;end;</source>
</StoredProcedureOraclev10g>